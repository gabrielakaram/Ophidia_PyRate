

pdf(file='C:/Users/Gabriela Karam/PyRate/Datasets/Ophidia_abril/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
rate=c(0.17635439694485947, 0.17621422835724143,0.17616430940320105,0.176154008496699,0.17614274166048532,0.1761361526650097,0.17612877915992164,0.1761261521759051,0.17612360256016973,0.17612877915992164,0.1761798546600738,0.17624167045884653,0.17623518990596798,0.1762347122386101,0.17623919289045925,0.17625157737023894,0.1762668320339006,0.1762756029329694,0.17628601442278063,0.17630343784924027,0.1763433493604888,0.1763585228876663,0.1763652789442074,0.17636778246330823,0.17636893207810364,0.1763798180943985,0.17639883231913894,0.17644512313077432,0.17662302303377947,0.17694962787900864,0.17741693822905408,0.17872614215296037,0.18100919770576673,0.18429890890245865,0.3621221099623859,0.45356649088631296,0.37770523499454334,0.26465678454895025,0.22922404474797606,0.2175876569850313,0.21169034295574402,0.21006078225558522,0.2101057987791397,0.2107844331374282,0.21161335052259897,0.21208395219952278,0.21246529342970205,0.21285805805733976,0.21389600372628315,0.21548108713166253,0.21730686083994755,0.2224175461147958,0.22564992298820247,0.2266826604654797,0.2271356223398439,0.22756916244372072,0.22802776101255584,0.22875847613083955,0.23076305423193388,0.23304900064147155,0.23580967033033773,0.23671644935465244,0.2369981858253414,0.23747859926768305,0.23785914555619664,0.2385142619782713,0.23974007206719972,0.24278311697666022,0.24548169469658265,0.24863757768535916,0.251681020164497,0.2564427072482206,0.26299682157966775,0.2741992804156035,0.28915536364328553,0.30206095028544006,0.31816106302071606,0.339641829741696,0.3651609670086639,0.40069122173773625,0.4494769174382283,0.5135450751855455,0.5841470726098599,0.6392181292289061,0.6933945948067255,0.7367173692943412,0.7756765022384509,0.8063576216635202,0.8372675823608251,0.8769948712422426,0.9740009403962012,1.032917839832316,1.0629024875362862,1.0784966598084837,1.0865092852149836,1.093662647245834,1.1006773452418024,1.108364325343799,1.116199487704199,1.12234937893034)
minHPD=c(0.15047688196748993, 0.15167559265181096,0.15132519253274399,0.15148749836768638,0.1514930529801872,0.15152557060732613,0.15141803015836805,0.15146310940236649,0.15146310940236649,0.15141803015836805,0.1514969392749431,0.15141030173490067,0.1514861711612616,0.151498354090392,0.15149092192114894,0.15148188685916758,0.1516803792053764,0.15118003575571146,0.1517959685725827,0.1516803792053764,0.1514969392749431,0.15132519253274399,0.15118086176141227,0.15109419573977015,0.15092743599112352,0.15062648035409354,0.15018728151246982,0.1503741928890592,0.15018359621745658,0.14826793411830935,0.14313338425874292,0.14323407861803317,0.14054388043876212,0.13929630344175667,0.1428662802219568,0.14551491431869853,0.13273740267597953,0.11069827492781094,0.08858909439982514,0.04774277093026284,0.10630106107166885,0.1254981125740545,0.1253739080826757,0.12546005765934115,0.12800873946964558,0.12889980075898722,0.1288126630486054,0.1292593482922829,0.13285330850287647,0.13384565351663508,0.134705569834007,0.12922099305840995,0.1254981125740545,0.12341267450457791,0.12610266829517963,0.12466136341672367,0.12614691067650227,0.1246899712037885,0.1252643457727721,0.12615873544098385,0.12834290900280784,0.1252643457727721,0.12454669769095757,0.12358576356772545,0.1255592950132515,0.11633875142244049,0.11027032764439393,0.09489355646494699,0.0947608092150962,0.03407444591631523,0.09737549022885689,0.03407444591631523,0.0947608092150962,0.10653024584939008,0.10653024584939008,0.10667556671616323,0.11676458683939805,0.1131826429191881,0.11734922499644543,0.11690503274116287,0.1236060007627621,0.11713723177752343,0.12171653048057952,0.12324041361480007,0.12383478874535872,0.12171653048057952,0.12468361131043218,0.12369541103888777,0.12631785144244106,0.12302478281033627,0.13543290393541363,0.13483448583348215,0.13537062493103016,0.13605743886722307,0.1303155938210828,0.133551969035519,0.13483448583348215,0.13483448583348215,0.12976414505340148,0.13605743886722307)
maxHPD=c(0.20237598912923976, 0.2023380315558822,0.20164205010285804,0.20169155505399605,0.20164259204832902,0.20164259204832902,0.20151602972583355,0.201537463575649,0.201537463575649,0.20150946571821993,0.20163485323052172,0.20168465346739786,0.20168283221817687,0.20171436713158689,0.2017517597047409,0.20179167487236685,0.20207256825441985,0.20163265644131642,0.20232671513753772,0.20232327034097414,0.20234276166483237,0.20234276166483237,0.2023380315558822,0.20238316485515334,0.20238150407123906,0.20238150407123906,0.20238316485515334,0.20326862753322528,0.2048686154321381,0.2075079437273238,0.2159086848412583,0.3047212203759296,0.46635141482411885,0.7577339174164349,1.7935259924917402,1.9724228505236754,1.897917414639807,1.5812823125246138,1.2449268072303308,0.9094829233736212,0.4175593966884342,0.39336930420895116,0.3905456688990876,0.38635622850283574,0.38501829480389826,0.38456434795827155,0.38419804287462966,0.38474280004707445,0.38906328707088395,0.3943476868451236,0.4015111060363738,0.4294984949550167,0.4671055572234433,0.4799536387568449,0.49132971099092587,0.49611790794607885,0.5044512557189832,0.5165727158920582,0.5622949236719212,0.6177419080634807,0.6900050595204351,0.7165707882021193,0.7396846992197283,0.7818529123780483,0.8341268388766178,0.9040963836073022,1.0344142563435492,1.2800072811197392,1.5352748212947132,1.847068634067262,2.109528548083731,2.217188802669077,2.4194240072688236,2.562961112681075,2.7190845587037824,2.8224327425064266,2.9167142873291296,2.9820494389572842,3.041052145162954,3.0850756613465338,3.136971157151777,3.173166793670826,3.2072930830054527,3.238558813086136,3.273481181560099,3.286428187299696,3.3067133327435,3.315208290543227,3.3278402733281163,3.3487499785702504,3.4589929315876735,3.5296625060461135,3.571063740552061,3.5887648763748246,3.5889136922754035,3.602451347437453,3.6116090654908044,3.6224811638111847,3.6259793299857077,3.6419738234408574)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.006171205784944), xlim = c(-165.450783,-0.0), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_10_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-0.8356100151515151, -2.5068300454545454,-4.178050075757575,-5.849270106060606,-7.520490136363636,-9.191710166666667,-10.862930196969698,-12.534150227272727,-14.205370257575757,-15.876590287878786,-17.547810318181817,-19.219030348484846,-20.890250378787876,-22.56147040909091,-24.232690439393938,-25.903910469696967,-27.575130499999997,-29.246350530303026,-30.91757056060606,-32.588790590909085,-34.26001062121212,-35.93123065151515,-37.602450681818176,-39.27367071212121,-40.94489074242424,-42.61611077272727,-44.2873308030303,-45.958550833333334,-47.62977086363636,-49.30099089393939,-50.97221092424242,-52.64343095454545,-54.314650984848484,-55.98587101515151,-57.65709104545454,-59.32831107575757,-60.9995311060606,-62.670751136363634,-64.34197116666667,-66.01319119696969,-67.68441122727272,-69.35563125757575,-71.02685128787878,-72.69807131818182,-74.36929134848485,-76.04051137878787,-77.7117314090909,-79.38295143939393,-81.05417146969697,-82.7253915,-84.39661153030302,-86.06783156060605,-87.73905159090909,-89.41027162121212,-91.08149165151515,-92.75271168181818,-94.4239317121212,-96.09515174242424,-97.76637177272727,-99.4375918030303,-101.10881183333333,-102.78003186363635,-104.45125189393939,-106.12247192424242,-107.79369195454545,-109.46491198484848,-111.1361320151515,-112.80735204545454,-114.47857207575757,-116.1497921060606,-117.82101213636363,-119.49223216666665,-121.16345219696969,-122.83467222727272,-124.50589225757575,-126.17711228787878,-127.84833231818182,-129.51955234848486,-131.1907723787879,-132.8619924090909,-134.53321243939394,-136.20443246969697,-137.8756525,-139.54687253030303,-141.21809256060607,-142.8893125909091,-144.56053262121213,-146.23175265151517,-147.9029726818182,-149.57419271212123,-151.24541274242424,-152.91663277272727,-154.5878528030303,-156.25907283333333,-157.93029286363637,-159.6015128939394,-161.27273292424243,-162.94395295454547,-164.6151729848485)
counts=c(0.0061806180618061805, 0.0022302230223022303,0.0008000800080008001,0.0006900690069006901,0.0006300630063006301,0.00072007200720072,0.00042004200420042004,0.00044004400440044003,0.0006100610061006101,0.00208020802080208,0.00222022202220222,0.0011901190119011902,0.00054005400540054,0.00071007100710071,0.0007000700070007,0.0008300830083008301,0.0008200820082008201,0.0009800980098009801,0.00144014401440144,0.0016101610161016102,0.00109010901090109,0.00107010701070107,0.00105010501050105,0.0013701370137013701,0.0016401640164016402,0.0021302130213021304,0.004090409040904091,0.00907090709070907,0.014161416141614161,0.03937393739373937,0.04117411741174117,0.09814981498149815,0.1788878887888789,0.24477447744774478,0.12828282828282828,0.13418341834183417,0.13661366136613662,0.14284428442844285,0.08076807680768076,0.058375837583758375,0.009260926092609261,0.004050405040504051,0.006810681068106811,0.00489048904890489,0.0033203320332033204,0.0027402740274027402,0.0038903890389038903,0.009520952095209522,0.009550955095509552,0.020912091209120912,0.02215221522152215,0.011691169116911692,0.004420442044204421,0.0037503750375037503,0.00402040204020402,0.004010401040104011,0.01017101710171017,0.011241124112411242,0.01738173817381738,0.01374137413741374,0.005750575057505751,0.008550855085508551,0.010301030103010301,0.011131113111311132,0.016001600160016,0.022062206220622063,0.021812181218121812,0.0287028702870287,0.025182518251825183,0.024752475247524754,0.033393339333933396,0.037833783378337836,0.049994999499949996,0.03493349334933493,0.03234323432343234,0.031863186318631866,0.028192819281928194,0.025652565256525654,0.02404240424042404,0.023002300230023004,0.022802280228022803,0.02125212521252125,0.022172217221722173,0.020232023202320232,0.01935193519351935,0.01675167516751675,0.016361636163616362,0.02045204520452045,0.04095409540954095,0.03202320232023202,0.017481748174817482,0.010711071107110712,0.00804080408040804,0.008280828082808282,0.0075307530753075305,0.0083008300830083,0.00793079307930793,0.007990799079907992,0.0072007200720072)
plot(mids,counts,type = 'h', xlim = c(-165.450783,-0.0), ylim=c(0,0.24477447744774478), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03534450657052072
bf6 = 0.2130516392520573
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
rate=c(0.13688973974588395, 0.13695759943382718,0.13765474787776577,0.13826534784822603,0.13843842822798058,0.13849525051128475,0.13851491253935005,0.13852001291414726,0.13851835199084556,0.13851835199084556,0.1385261319146755,0.1385268122682909,0.13854807073963993,0.13864202149454324,0.13890276685710118,0.13949652547314245,0.14022054861615685,0.14203620760189523,0.14599209010655198,0.1527131509946815,0.154854436526603,0.1543089890026368,0.1537577446564724,0.15380017871087692,0.15396905491792362,0.15425410843003967,0.1545488528084327,0.15494013308472054,0.15559350923856835,0.15602988594695613,0.15628325675247484,0.1563611988040877,0.15657325018066354,0.1571473586295219,0.16063631040098084,0.17017344977105325,0.17757287012774853,0.18320088665405923,0.1844304598692013,0.18632693019695976,0.1886479091698899,0.17354166857570424,0.17124589060531575,0.17059110632025948,0.17039757695649027,0.17038884577958913,0.17046449839643513,0.17066869637695964,0.17101636574756585,0.1715088360078727,0.17230570966837278,0.17350024650095033,0.17560835441989897,0.18005348693151024,0.1847146909791626,0.18964257975880394,0.19369221182598348,0.19496994110174276,0.19430907190174843,0.1934502449497023,0.19306648336672688,0.1903365791743158,0.1897827980918969,0.18976688959454388,0.18995209838242788,0.19024476734336643,0.1907994784746163,0.1917387031915861,0.19298617991040118,0.1945706618135053,0.19656521041487854,0.1989519991135784,0.2020757451367749,0.20681386409899477,0.21361185915553688,0.22354952482202484,0.2412567297266467,0.2800488593935456,0.3296899514656466,0.42157435524058945,0.5186748830223341,0.5963215168163603,0.6696062176555159,0.7322092866564104,0.7983165736308513,0.8480306550533847,0.894256005847244,0.9276172643009053,0.9612955123937031,0.9850089974836074,1.0192495843729485,1.0649626606170377,1.0958648485747258,1.1101716820532264,1.1193207459074375,1.1285244439130286,1.1365884576088945,1.1446637887100264,1.1537259520412957,1.160333108954858)
minHPD=c(0.10001666821438797, 0.10090104691809271,0.10343716421102471,0.10484816721151238,0.10487165170129767,0.10485165120096969,0.1049316302733871,0.10517444087490149,0.10514182674364722,0.10483133554304401,0.10497527177484088,0.1049316302733871,0.10497527177484088,0.10496467741157349,0.10415501087131224,0.10197905222341387,0.10028318889907877,0.10035598433138634,0.10411922274961437,0.10189808774838308,0.11134369706189978,0.11917035965047307,0.12281814291526116,0.12257293759901278,0.12281814291526116,0.12305640110090879,0.12430136732476486,0.1240637836487563,0.12401658765679438,0.1246026432350749,0.12503378680844024,0.12452939552180091,0.12397051913189629,0.12381908024184897,0.11798057927657093,0.1149664194296605,0.11373061861464047,0.11801162000253851,0.11715841234161795,0.1149932555449941,0.11421342224919816,0.05234477585442871,0.06473165383564516,0.07079892933915238,0.07104740817089605,0.07081759994075577,0.06793578602222079,0.07103046921819837,0.06792322485700758,0.06590092963329505,0.0719325359720612,0.07107564357683543,0.05849406053707148,0.04790074654594425,0.042697240870807375,0.07848704036822733,0.09736443564071763,0.10202807222934253,0.09758303868563047,0.09392168952022929,0.08589786184169568,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,3.9788020945093186e-05,7.020827833894094e-06,3.9788020945093186e-05,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,1.037946732075991e-05,1.037946732075991e-05,5.6065497045598656e-05,0.09138466478522475,0.09165665583809518,0.09743257253113068,0.09786709658864544,0.10301929172438902,0.10550607681608773,0.09798412248213909,0.10679408575297013,0.10986334666494267,0.11144966068701401,0.10198561845587088,0.10629345427141199,0.10301929172438902,0.11608506587103913)
maxHPD=c(0.16890968930895256, 0.16897519280462756,0.16675713434303804,0.16564983549290982,0.1652641047008649,0.16526379422597132,0.1653536756065523,0.16561625745651856,0.16564757611318567,0.16541132786847643,0.16564983549290982,0.165814488216819,0.16615139043972443,0.1667766849699044,0.16755800604156562,0.16970044555626235,0.1760195343766718,0.19671101304815095,0.2195738346404874,0.4281210184658976,0.4916245493761861,0.23853060220432828,0.22705269674290052,0.22601391274553054,0.22601391274553054,0.22616882521877127,0.22747754603069242,0.22748148290573403,0.22859625300224407,0.23056721448003964,0.23194660906127462,0.23194660906127462,0.2327849549465931,0.23621816448506472,0.28190524871586703,0.8515110369483677,1.1061041764407358,1.3297012628027245,1.2901905578072723,1.3383692308070478,1.4849654654156823,0.32078705216231995,0.29763134503711625,0.29778648383076795,0.29955640507848075,0.3000991512941555,0.2977250436786837,0.3016379105313719,0.29995809267386986,0.2999143605171086,0.3096694999378337,0.31663274630044724,0.32078705216231995,0.36779643422219815,0.4964640177446084,0.6307565384086591,0.6716387591621364,0.6832993131998053,0.6638783418581278,0.6770058161029268,0.6882726578546025,0.5955353742052913,0.5986548560901233,0.6150826458910006,0.641895175352799,0.6812365509479558,0.7496446843864139,0.8918614370095507,1.181955948149925,1.553456987642895,1.8604778149420393,2.0716318122123476,2.258811895291034,2.4262415838764744,2.5796795654801286,2.7244243162957806,2.845284765805159,2.9522305567833786,3.0176872177085676,3.0751661686368084,3.1238496611579953,3.17153647854884,3.2127016576784446,3.250217685217891,3.2884671921010784,3.307891961717467,3.405927641908738,3.4054594481279916,3.4085805775004707,3.408408827614894,3.4381753137972835,3.4901235803949016,3.5200332933965472,3.546767462355524,3.5572147488322368,3.5695996981824214,3.5691523913163308,3.5809328227967785,3.5856796873363934,3.607120822949321)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.9678329052442534), xlim = c(-165.450783,-0.0), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-0.8356100151515151, -2.5068300454545454,-4.178050075757575,-5.849270106060606,-7.520490136363636,-9.191710166666667,-10.862930196969698,-12.534150227272727,-14.205370257575757,-15.876590287878786,-17.547810318181817,-19.219030348484846,-20.890250378787876,-22.56147040909091,-24.232690439393938,-25.903910469696967,-27.575130499999997,-29.246350530303026,-30.91757056060606,-32.588790590909085,-34.26001062121212,-35.93123065151515,-37.602450681818176,-39.27367071212121,-40.94489074242424,-42.61611077272727,-44.2873308030303,-45.958550833333334,-47.62977086363636,-49.30099089393939,-50.97221092424242,-52.64343095454545,-54.314650984848484,-55.98587101515151,-57.65709104545454,-59.32831107575757,-60.9995311060606,-62.670751136363634,-64.34197116666667,-66.01319119696969,-67.68441122727272,-69.35563125757575,-71.02685128787878,-72.69807131818182,-74.36929134848485,-76.04051137878787,-77.7117314090909,-79.38295143939393,-81.05417146969697,-82.7253915,-84.39661153030302,-86.06783156060605,-87.73905159090909,-89.41027162121212,-91.08149165151515,-92.75271168181818,-94.4239317121212,-96.09515174242424,-97.76637177272727,-99.4375918030303,-101.10881183333333,-102.78003186363635,-104.45125189393939,-106.12247192424242,-107.79369195454545,-109.46491198484848,-111.1361320151515,-112.80735204545454,-114.47857207575757,-116.1497921060606,-117.82101213636363,-119.49223216666665,-121.16345219696969,-122.83467222727272,-124.50589225757575,-126.17711228787878,-127.84833231818182,-129.51955234848486,-131.1907723787879,-132.8619924090909,-134.53321243939394,-136.20443246969697,-137.8756525,-139.54687253030303,-141.21809256060607,-142.8893125909091,-144.56053262121213,-146.23175265151517,-147.9029726818182,-149.57419271212123,-151.24541274242424,-152.91663277272727,-154.5878528030303,-156.25907283333333,-157.93029286363637,-159.6015128939394,-161.27273292424243,-162.94395295454547,-164.6151729848485)
counts=c(0.0022302230223022303, 0.018041804180418043,0.014921492149214921,0.0042104210421042105,0.0017701770177017701,0.0009000900090009,0.0006600660066006601,0.0009000900090009,0.0008900890089008901,0.00112011201120112,0.0013101310131013102,0.00199019901990199,0.0039203920392039205,0.00864086408640864,0.01632163216321632,0.023292329232923292,0.05293529352935294,0.10623062306230623,0.14660466046604662,0.029602960296029605,0.06755675567556756,0.015991599159915992,0.0036703670367036704,0.0042904290429042905,0.0061406140614061406,0.005530553055305531,0.008920892089208921,0.011501150115011502,0.006280628062806281,0.0046204620462046205,0.0033403340334033403,0.00547054705470547,0.020572057205720574,0.07311731173117311,0.05732573257325733,0.048834883488348836,0.02304230423042304,0.01669166916691669,0.0268026802680268,0.06993699369936994,0.11448144814481448,0.01065106510651065,0.004060406040604061,0.00286028602860286,0.0021702170217021703,0.0019001900190019003,0.00267026702670267,0.0035003500350035003,0.004960496049604961,0.007640764076407641,0.009770977097709771,0.0223022302230223,0.031733173317331734,0.036623662366236626,0.03565356535653565,0.021632163216321634,0.013391339133913391,0.014751475147514752,0.00798079807980798,0.021282128212821282,0.013011301130113012,0.00827082708270827,0.009850985098509851,0.01142114211421142,0.014571457145714572,0.018201820182018203,0.0224022402240224,0.024972497249724973,0.02917291729172917,0.029732973297329733,0.031543154315431546,0.037233723372337234,0.04191419141914191,0.04494449444944494,0.04551455145514551,0.0464046404640464,0.036053605360536055,0.03414341434143414,0.032503250325032505,0.028572857285728573,0.03081308130813081,0.028522852285228523,0.029522952295229523,0.025082508250825083,0.025022502250225023,0.021232123212321232,0.020052005200520053,0.016621662166216623,0.018841884188418843,0.02484248424842484,0.018681868186818683,0.01147114711471147,0.008840884088408841,0.009180918091809182,0.00927092709270927,0.00935093509350935,0.009080908090809081,0.008290829082908291,0.007940794079407941)
plot(mids,counts,type = 'h', xlim = c(-165.450783,-0.0), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
net_rate=c(0.0435621882390433, 0.042343921487610084,0.04060275306013599,0.039420380492504285,0.03911881475165359,0.039012327246423006,0.03897300677850009,0.03897364054861178,0.03899118450524212,0.03901116134991851,0.03912623182832443,0.03953366159584161,0.03923142243761807,0.03909713024498191,0.03867976947949323,0.03767874968972091,0.03644182580795636,0.03296922405608029,0.023517011995119567,-0.009904270697424354,-0.019133832800102522,0.0029524010088776056,0.012518095821523674,0.012756625179679444,0.012551094964976283,0.01216409844967532,0.01178563316275948,0.011365984805684752,0.01088104799208666,0.01154214380713624,0.01375160142030167,0.023457449316569713,0.05062315898221859,0.10443086158058348,0.44765204734465225,0.466782214591628,0.371381918448139,0.1712867022613281,0.031971215239355213,-0.05455486678281195,-0.1308179982389355,0.034369577487152435,0.04677057283746489,0.04921768116440377,0.05052520745005399,0.05101747701420036,0.05127265777119443,0.051481599047807136,0.052383776316279544,0.05434292609846128,0.05626469075550881,0.06625906406307606,0.06909972572431472,0.05816356363323228,0.04262335168636672,0.024719554638216488,0.010045869667049356,0.008901957278587336,0.024226282019798855,0.036972160430001,0.05014989534608448,0.06385276484560477,0.06784048182127357,0.07357143314128091,0.07506112595169984,0.07587732997104084,0.0777198814943401,0.08452400774666906,0.08251671843896066,0.09198528515005236,0.08135074496315699,0.07564786652209152,0.07160013221269947,0.07696793321620739,0.08564566301048168,0.0675701657517219,0.044581557999729245,0.021588318828423794,0.012287712562745755,-0.00041167701460938596,-0.011035612419140054,-0.01952503880071825,-0.028710783254501295,-0.03771869969771396,-0.047277046702222485,-0.05362040439558261,-0.06028020843913113,-0.06479692744400706,-0.06943831339620225,-0.058074866257711265,-0.008063122789134552,0.0024310244390526757,0.0019307410486356113,0.0012984034011168694,0.0003307297141220915,-0.0008942403128981733,-0.0032134901670097474,-0.0036878258176422244,-0.004540530049422733,-0.005320051299109641)
net_minHPD=c(-0.00175809471914129, -0.001213400427128114,0.0005477649409746932,0.001988974096838375,0.0025034185215848936,0.0022817289761183357,0.002285571937959474,0.0022968834186656295,0.00226934875838275,0.002152077194591401,0.0020111626819920847,0.001944766725707786,0.0017712382381675218,0.0008236676135829624,-0.0002566533616582267,-0.0029710260789487797,-0.007699185694082594,-0.024806114595340517,-0.047246925286179325,-0.2569513150499746,-0.3246971267783819,-0.0659243813208116,-0.05415878152217521,-0.05305586967721301,-0.053085130988913126,-0.05354212378070056,-0.05415062463175774,-0.055945428640431144,-0.058174873281325146,-0.06270419232049906,-0.07360262353013733,-0.08359890167871567,-0.08283792114903096,-0.0957739355719189,-0.0765903074815828,-0.15496924295594894,-0.5178512802250015,-0.783611384748141,-0.9651178352088734,-1.1731805409586233,-1.3732349504972026,-0.10262600656015833,-0.07405506576060017,-0.07060421396795366,-0.06790893989525718,-0.06754502072464522,-0.06623147469749782,-0.06514741046396072,-0.0679395102337661,-0.06819667879076802,-0.07494625985499331,-0.10817758224650198,-0.14137168905547257,-0.1972899312546289,-0.363183545025614,-0.3948492031335029,-0.4206854361635899,-0.40848921126934584,-0.3416380781610662,-0.2960695279739684,-0.2937142354901321,-0.24534384418923938,-0.260903790720754,-0.28209401881303026,-0.33675236434053846,-0.36954914974825653,-0.581723067140423,-0.9230878853648679,-1.360962363094856,-1.6330451330958047,-1.848241698274575,-1.9706569687450244,-2.145298869264498,-2.32501022644246,-2.5100214338984452,-2.5856545757388667,-2.6622114012669216,-2.7233691625991674,-2.7298771665503905,-2.742696856031108,-2.7327001174907544,-2.7840404304748936,-2.744838611986342,-2.7358120152089773,-2.676499168006786,-2.679609808409061,-2.703822431785,-2.67300260479709,-2.6737670380603342,-2.591635410679092,-2.730164921761081,-2.733394361137364,-2.731605692452664,-2.7499575207988207,-2.7413206156907366,-2.7413206156907366,-2.803177579711121,-2.8240340724458903,-2.797294878588954,-2.819747809492027)
net_maxHPD=c(0.08949350775691384, 0.08556526258202592,0.08040777235083214,0.0785275149652011,0.07842934282008406,0.07812366429867174,0.07812366429867174,0.07813292154754979,0.078122006548253,0.07812366429867174,0.0782520353459529,0.07875162483888662,0.07875874054458298,0.07836193244729886,0.07898026729728459,0.08086892422049383,0.08293714473373522,0.08232338507790131,0.0781219233413854,0.08612974994152539,0.07470544122253939,0.06778124729258472,0.06188739735395643,0.06216224149506122,0.06215211264564277,0.062040230058535484,0.06211389618176519,0.06141881667724805,0.06236427568085312,0.06442995483510967,0.06788990312888096,0.14617411148666037,0.3038558390949912,0.6003526370404703,1.6505224313601001,1.927908224579108,1.887144889073307,1.4556470532705252,1.0730420847228048,0.7814530023260364,0.27333851527102226,0.22262840385680965,0.19931913428890602,0.1920946523565831,0.1920946523565831,0.19208178799721043,0.1936636184978427,0.19574150609146135,0.19574150609146135,0.20330346545445685,0.2150474719079244,0.2667356752744504,0.37713758575652756,0.43098996798757105,0.33006939975237426,0.3192252874458814,0.28529765656358574,0.2925771078176206,0.2871120169063051,0.30185253827952063,0.32656759929466006,0.35327971927487867,0.3684058100483746,0.42627186605938505,0.49660986976895716,0.7260263200438503,1.0242911863722575,1.4927872252306453,1.6618838039726087,2.0321833933795173,2.1767379578383226,2.3602886626061568,2.456290830065932,2.492270778591848,2.607379855936376,2.6747182212714247,2.6809556892363458,2.659444837025904,2.6615918211842704,2.6601989242689696,2.6601989242689696,2.5785966979847563,2.5740998865902145,2.528427483495412,2.5229702520753365,2.492861714340282,2.4548908735285475,2.4588466479412423,2.4216397888374805,2.481291192458401,2.522910970326653,2.7029072665218257,2.7710228196441307,2.7801287269121446,2.8090269385201934,2.8328575464989054,2.7891764868155353,2.7891764868155353,2.83572245354388,2.830693122262363)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-3.1064374796904795, 3.119294698898268), xlim = c(-165.450783,-0.0), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
rate=c(7.4626979332033665, 7.453332529745718,7.368604837202561,7.306347103675044,7.291503044857724,7.286650010169644,7.2856126578439895,7.286178589289083,7.287200475244636,7.287664305325449,7.28784871752527,7.288809510327071,7.288139520048362,7.281729438343686,7.259135186121198,7.205920453124617,7.140879556622904,6.966983487361083,6.5353402704831,5.361940030196673,5.1063958182449545,5.755279762445534,6.0903199465430795,6.09920604589773,6.091719497044332,6.076609919737068,6.061622038958951,6.041122292403486,6.000899373069311,5.974357345409805,5.960810945117604,5.957168873787946,5.9421308694278,5.895031003142502,5.161039131248928,3.9024292967320853,3.304625127471666,2.9034540692070157,2.9435803032618004,2.841645982126734,2.6595206484469136,5.145335850119154,5.503609054157455,5.555089089042599,5.564237165346449,5.565638622633199,5.563793728538054,5.558607507693339,5.54745638160724,5.528261361089057,5.487716654417842,5.417320883580972,5.2610816357290116,4.917555478359359,4.548807613284792,4.193894325450591,3.939532995148977,3.897624968295244,4.051996059164303,4.129544665585611,4.1519414249706585,4.3126017634029195,4.3190680511579105,4.235172924989157,4.044737631930376,3.8043612066585215,3.536519021128211,3.2226814325936384,2.9150668884560926,2.607101827444003,2.336426224006754,2.119495518674211,1.9240935875386098,1.7413728577561776,1.5707029311572631,1.420137489381951,1.2935527475664748,1.1873660550838052,1.1258325898241266,1.0703152422162983,1.023793790140188,0.9857952114092563,0.9488347941039055,0.9175727459427054,0.8866603975461113,0.864878379284186,0.8449375677950721,0.8295213638095683,0.8149698364445096,0.8040297461574206,0.7874522228771679,0.7628772157839209,0.7476934218076077,0.7406592549252392,0.7365970520678271,0.7323730256603956,0.7284128871709922,0.7247618227548864,0.7208757108775048,0.7173421555451639)
minHPD=c(7.4626979332033665, 7.453332529745718,7.368604837202561,7.306347103675044,7.291503044857724,7.286650010169644,7.2856126578439895,7.286178589289083,7.287200475244636,7.287664305325449,7.28784871752527,7.288809510327071,7.288139520048362,7.281729438343686,7.259135186121198,7.205920453124617,7.140879556622904,6.966983487361083,6.5353402704831,5.361940030196673,5.1063958182449545,5.755279762445534,6.0903199465430795,6.09920604589773,6.091719497044332,6.076609919737068,6.061622038958951,6.041122292403486,6.000899373069311,5.974357345409805,5.960810945117604,5.957168873787946,5.9421308694278,5.895031003142502,5.161039131248928,3.9024292967320853,3.304625127471666,2.9034540692070157,2.9435803032618004,2.841645982126734,2.6595206484469136,5.145335850119154,5.503609054157455,5.555089089042599,5.564237165346449,5.565638622633199,5.563793728538054,5.558607507693339,5.54745638160724,5.528261361089057,5.487716654417842,5.417320883580972,5.2610816357290116,4.917555478359359,4.548807613284792,4.193894325450591,3.939532995148977,3.897624968295244,4.051996059164303,4.129544665585611,4.1519414249706585,4.3126017634029195,4.3190680511579105,4.235172924989157,4.044737631930376,3.8043612066585215,3.536519021128211,3.2226814325936384,2.9150668884560926,2.607101827444003,2.336426224006754,2.119495518674211,1.9240935875386098,1.7413728577561776,1.5707029311572631,1.420137489381951,1.2935527475664748,1.1873660550838052,1.1258325898241266,1.0703152422162983,1.023793790140188,0.9857952114092563,0.9488347941039055,0.9175727459427054,0.8866603975461113,0.864878379284186,0.8449375677950721,0.8295213638095683,0.8149698364445096,0.8040297461574206,0.7874522228771679,0.7628772157839209,0.7476934218076077,0.7406592549252392,0.7365970520678271,0.7323730256603956,0.7284128871709922,0.7247618227548864,0.7208757108775048,0.7173421555451639)
maxHPD=c(7.4626979332033665, 7.453332529745718,7.368604837202561,7.306347103675044,7.291503044857724,7.286650010169644,7.2856126578439895,7.286178589289083,7.287200475244636,7.287664305325449,7.28784871752527,7.288809510327071,7.288139520048362,7.281729438343686,7.259135186121198,7.205920453124617,7.140879556622904,6.966983487361083,6.5353402704831,5.361940030196673,5.1063958182449545,5.755279762445534,6.0903199465430795,6.09920604589773,6.091719497044332,6.076609919737068,6.061622038958951,6.041122292403486,6.000899373069311,5.974357345409805,5.960810945117604,5.957168873787946,5.9421308694278,5.895031003142502,5.161039131248928,3.9024292967320853,3.304625127471666,2.9034540692070157,2.9435803032618004,2.841645982126734,2.6595206484469136,5.145335850119154,5.503609054157455,5.555089089042599,5.564237165346449,5.565638622633199,5.563793728538054,5.558607507693339,5.54745638160724,5.528261361089057,5.487716654417842,5.417320883580972,5.2610816357290116,4.917555478359359,4.548807613284792,4.193894325450591,3.939532995148977,3.897624968295244,4.051996059164303,4.129544665585611,4.1519414249706585,4.3126017634029195,4.3190680511579105,4.235172924989157,4.044737631930376,3.8043612066585215,3.536519021128211,3.2226814325936384,2.9150668884560926,2.607101827444003,2.336426224006754,2.119495518674211,1.9240935875386098,1.7413728577561776,1.5707029311572631,1.420137489381951,1.2935527475664748,1.1873660550838052,1.1258325898241266,1.0703152422162983,1.023793790140188,0.9857952114092563,0.9488347941039055,0.9175727459427054,0.8866603975461113,0.864878379284186,0.8449375677950721,0.8295213638095683,0.8149698364445096,0.8040297461574206,0.7874522228771679,0.7628772157839209,0.7476934218076077,0.7406592549252392,0.7365970520678271,0.7323730256603956,0.7284128871709922,0.7247618227548864,0.7208757108775048,0.7173421555451639)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.208967726523705), xlim = c(-165.450783,-0.0), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()