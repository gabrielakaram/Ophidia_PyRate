

pdf(file='C:/Users/Gabriela Karam/PyRate/Datasets/Ophidia_abril/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
rate=c(0.17629834174333012, 0.1761477795843054,0.1760955930773742,0.1760883824601979,0.1760770159888915,0.1760706836687077,0.17606341033592143,0.17605794830925914,0.17605738402584742,0.17606457082257912,0.17611447029335464,0.1761720933068048,0.17616656675796372,0.17616654849556798,0.17617187188997224,0.17617973337406684,0.17619548978302296,0.1762084616983159,0.17621952526882018,0.17624602933590594,0.17628315533191097,0.17629768998399792,0.1763025662172928,0.1763044481319378,0.17630555659260327,0.17632150375920239,0.17634382811855567,0.17638652816373562,0.17655893866836575,0.17688289945206728,0.1773846771251557,0.17877106034893128,0.18111574408362457,0.1844520670335142,0.367536092756356,0.457178704656695,0.38264681616260965,0.26711083961147086,0.23068143319532391,0.21844168567056532,0.2121475734562448,0.21018211551607696,0.21013546766654836,0.2108427843366934,0.21169034295574402,0.21215261742881283,0.2125150696276124,0.21294298315661384,0.21396172158510218,0.21552138857199482,0.21736730207116395,0.2224492266022834,0.22552216857003615,0.2265882811662175,0.22704361675289048,0.22746064623112938,0.2279767157689491,0.2286829976669149,0.23048414045391333,0.23290265088261863,0.23573752118226635,0.23665114291439351,0.23695211392791704,0.23745102055175168,0.2378437889970798,0.23850396999883938,0.23973346806520535,0.24279861165104055,0.24548854342545207,0.24863757768535916,0.2517006404061283,0.25644524767757504,0.26300223381790067,0.2742122787319168,0.28923970320616843,0.30217192257573144,0.31832268884775317,0.34002593786809077,0.3659001334429387,0.40172010488141985,0.4524877262022619,0.5175214751618507,0.5872972919291535,0.6418823539029115,0.6966683076219728,0.7405424088103417,0.7817116316349911,0.811669842718423,0.8418482343664289,0.8821298080845201,0.9772640006789228,1.0375560889630102,1.0688510914578973,1.082872337240338,1.0905679005068205,1.098441032984736,1.1047976034450733,1.1127825874939394,1.12049690984369,1.1267420115504465)
minHPD=c(0.15018451663461677, 0.15108857514646953,0.15095617789435972,0.1510247564336105,0.15108857514646953,0.15112683328408308,0.151147992621765,0.15118003575571146,0.15118003575571146,0.151147992621765,0.15108857514646953,0.1509830594365322,0.1510247564336105,0.15100594285981864,0.1509958479579132,0.15115057263825574,0.1511747874524312,0.1513027424584973,0.15118003575571146,0.15108857514646953,0.15118522597396855,0.1510340587606448,0.15093479092861262,0.1508041184903983,0.1506517099581464,0.15035766129719,0.1503741928890592,0.1506407471728696,0.14943906253904657,0.1470694061150047,0.14323407861803317,0.1423156479260841,0.1396284532465231,0.1387297957410624,0.1428662802219568,0.14311418107808316,0.13285330850287647,0.10619066427240825,0.08730998034485059,0.04774277093026284,0.10516143176002238,0.11810555179075181,0.1210820230364309,0.12476535370044618,0.12483899205395448,0.12638415361627817,0.1266490931867354,0.12648106944478602,0.13009041817449157,0.12998993592957436,0.12920992030059378,0.12864611470307022,0.12358576356772545,0.1246276966149652,0.12230639600271298,0.12464212926515635,0.1218730520237263,0.12545126823688255,0.12447611975796122,0.12468361131043218,0.12656860065956566,0.1254993399623055,0.12615873544098385,0.12468361131043218,0.12358576356772545,0.11637826555211983,0.10983396426707567,0.0947608092150962,0.10749579145645889,0.09489355646494699,0.09429774600950867,0.0947608092150962,0.0965185038527293,0.10653024584939008,0.1071909306264306,0.10427630833086259,0.10665411142814539,0.109021577547824,0.11734922499644543,0.11734922499644543,0.12176892656059637,0.12392926263187373,0.11922614001114717,0.1239789955864848,0.12171653048057952,0.1184009051594383,0.12392926263187373,0.12392926263187373,0.12468361131043218,0.12458251659559398,0.12960935936149082,0.13241855353832385,0.13605743886722307,0.13483448583348215,0.14050017046275556,0.1320850966047623,0.13537062493103016,0.14023300013311207,0.13400405995454154,0.13464164464001127)
maxHPD=c(0.20240243339140557, 0.20204512441647493,0.20153514712600984,0.20151057435675124,0.20151414404177972,0.20151602972583355,0.20152268545026641,0.201537463575649,0.20153130994777552,0.20152268545026641,0.20151057435675124,0.20154378724291055,0.20151414404177972,0.20151057435675124,0.20154378724291055,0.20175092217329663,0.20185032301260594,0.20203546571723063,0.20200605010036057,0.20203302090577197,0.2023380315558822,0.20233991870921894,0.20238150407123906,0.20238316485515334,0.20238072021840653,0.20238150407123906,0.20283880458603484,0.20381183293224708,0.2044254155670558,0.20655966914930735,0.21674860335483695,0.31204669412978714,0.46800139658079626,0.7572691241143582,1.793424183802201,1.9686513238695758,1.8962708755137425,1.5762275744276006,1.2448948141808391,0.9094135597818561,0.4194302474430329,0.3891497150131401,0.3894381083066789,0.38887275759163625,0.38500112521132007,0.3851529845195389,0.38500448060667386,0.38501829480389826,0.3894381083066789,0.39383137111941113,0.39968049248563436,0.4305659967988014,0.4624828556699324,0.4776605115323065,0.4832184848676104,0.4911963887058126,0.4954932873238972,0.5122268100556955,0.5490590552777921,0.6080804579458002,0.6855531597209086,0.7112505519879223,0.7373086972208098,0.7860673103011963,0.844345999330385,0.9201730162396955,1.0549328087356407,1.3193305967888707,1.595709777983472,1.9436309565669136,2.136382515406367,2.2996392565241215,2.442254787803439,2.576281663755182,2.7340454890987327,2.833480195018734,2.9172375559809347,2.988262803198553,3.053120421224587,3.0960886621539636,3.14629985253587,3.191441747759613,3.216780378691793,3.250887634553608,3.280765382293541,3.295836254194759,3.314664229427148,3.3235933425590463,3.33275279112603,3.3583130274388266,3.4601762921528096,3.540676454476213,3.5856025636804842,3.6028649514460493,3.6145485309602434,3.614827256698218,3.6259793299857077,3.641360724916098,3.6426324653414475,3.654863217645665)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.0203495394102315), xlim = c(-165.450783,-0.0), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_10_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-0.8356100151515151, -2.5068300454545454,-4.178050075757575,-5.849270106060606,-7.520490136363636,-9.191710166666667,-10.862930196969698,-12.534150227272727,-14.205370257575757,-15.876590287878786,-17.547810318181817,-19.219030348484846,-20.890250378787876,-22.56147040909091,-24.232690439393938,-25.903910469696967,-27.575130499999997,-29.246350530303026,-30.91757056060606,-32.588790590909085,-34.26001062121212,-35.93123065151515,-37.602450681818176,-39.27367071212121,-40.94489074242424,-42.61611077272727,-44.2873308030303,-45.958550833333334,-47.62977086363636,-49.30099089393939,-50.97221092424242,-52.64343095454545,-54.314650984848484,-55.98587101515151,-57.65709104545454,-59.32831107575757,-60.9995311060606,-62.670751136363634,-64.34197116666667,-66.01319119696969,-67.68441122727272,-69.35563125757575,-71.02685128787878,-72.69807131818182,-74.36929134848485,-76.04051137878787,-77.7117314090909,-79.38295143939393,-81.05417146969697,-82.7253915,-84.39661153030302,-86.06783156060605,-87.73905159090909,-89.41027162121212,-91.08149165151515,-92.75271168181818,-94.4239317121212,-96.09515174242424,-97.76637177272727,-99.4375918030303,-101.10881183333333,-102.78003186363635,-104.45125189393939,-106.12247192424242,-107.79369195454545,-109.46491198484848,-111.1361320151515,-112.80735204545454,-114.47857207575757,-116.1497921060606,-117.82101213636363,-119.49223216666665,-121.16345219696969,-122.83467222727272,-124.50589225757575,-126.17711228787878,-127.84833231818182,-129.51955234848486,-131.1907723787879,-132.8619924090909,-134.53321243939394,-136.20443246969697,-137.8756525,-139.54687253030303,-141.21809256060607,-142.8893125909091,-144.56053262121213,-146.23175265151517,-147.9029726818182,-149.57419271212123,-151.24541274242424,-152.91663277272727,-154.5878528030303,-156.25907283333333,-157.93029286363637,-159.6015128939394,-161.27273292424243,-162.94395295454547,-164.6151729848485)
counts=c(0.006350635063506351, 0.00239023902390239,0.00074007400740074,0.0007000700070007,0.0006400640064006401,0.00071007100710071,0.00044004400440044003,0.00036003600360036,0.00058005800580058,0.00204020402040204,0.00222022202220222,0.0012201220122012202,0.00054005400540054,0.0006300630063006301,0.0006800680068006801,0.0008800880088008801,0.0008500850085008501,0.0009700970097009701,0.00147014701470147,0.0016001600160016002,0.00107010701070107,0.0009800980098009801,0.00105010501050105,0.0013701370137013701,0.0015301530153015303,0.00212021202120212,0.004340434043404341,0.009110911091109111,0.014131413141314131,0.04184418441844184,0.042074207420742075,0.09828982898289829,0.1796979697969797,0.24474447444744474,0.12811281128112811,0.1341034103410341,0.13647364736473647,0.14356435643564355,0.08171817181718172,0.05972597259725972,0.01054105410541054,0.00423042304230423,0.006820682068206821,0.00486048604860486,0.0033403340334033403,0.0027502750275027505,0.0038303830383038303,0.00951095109510951,0.009520952095209522,0.020602060206020602,0.021702170217021702,0.01144114411441144,0.0042004200420042,0.0037003700370037006,0.004000400040004,0.00411041104110411,0.009580958095809581,0.01097109710971097,0.018151815181518153,0.014231423142314232,0.005650565056505651,0.00877087708770877,0.011611161116111612,0.010951095109510952,0.016301630163016303,0.02231223122312231,0.02209220922092209,0.028692869286928692,0.02552255225522552,0.024382438243824384,0.03318331833183318,0.03776377637763777,0.05005500550055005,0.03486348634863486,0.03248324832483249,0.031763176317631765,0.028302830283028303,0.02552255225522552,0.023982398239823982,0.023222322232223223,0.02278227822782278,0.02135213521352135,0.022072207220722073,0.02002200220022002,0.019421942194219423,0.01665166516651665,0.016051605160516052,0.020432043204320433,0.040844084408440846,0.03202320232023202,0.01764176417641764,0.010711071107110712,0.0079007900790079,0.008420842084208421,0.007560756075607561,0.00832083208320832,0.00804080408040804,0.00808080808080808,0.007190719071907191)
plot(mids,counts,type = 'h', xlim = c(-165.450783,-0.0), ylim=c(0,0.24474447444744474), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03514394028058949
bf6 = 0.2120643392777693
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
rate=c(0.13684190139417385, 0.1369235335547232,0.13760611254433391,0.13821178896413078,0.13838917629878628,0.1384430286040838,0.13846005915292903,0.13846324300063928,0.13846094571845213,0.13846094571845213,0.13846702252458537,0.13846844896236712,0.13849277881322625,0.13858407362148606,0.13884449256859413,0.13943367641910148,0.1401540950355136,0.14198564942722758,0.14592450442521404,0.1526643621379185,0.15480062379070259,0.15427017738325643,0.15371102508713128,0.15375024669636211,0.15392000021022584,0.1542052964847163,0.15448691118612007,0.1548805280377824,0.15556038926344568,0.15598053438287124,0.15623613268049263,0.15631321464282225,0.1565196139831106,0.15711413681780628,0.1606599600843221,0.17039620982074408,0.17802450263726302,0.18383114659056382,0.1852105857909889,0.18751711150453737,0.19088618641097194,0.1736654769599271,0.17124218250425788,0.17057769774675247,0.17038958634213885,0.17037281330559195,0.1704510036344593,0.17065641872238327,0.17100051628519486,0.17150372807505246,0.1723063448441983,0.17344920745417164,0.17561597460735107,0.18009451998121162,0.18478390973177738,0.18962699501278762,0.19372079235022963,0.19499260238851063,0.19430907190174843,0.19344640916794087,0.19301414744619394,0.19028226628098577,0.18974486180109656,0.189721751990392,0.18991550847695432,0.19020408078619122,0.19074583092609113,0.1916989407615156,0.19296608498336593,0.19453555811744694,0.19652582323625706,0.19889689206159533,0.20200875729690276,0.20674876412768872,0.2135360809284712,0.22341342642385054,0.24099729346387577,0.27957765170467896,0.3290121933599457,0.4210151383095371,0.5176589535948461,0.5940404846697751,0.667140052358459,0.7297172226363363,0.7958858429440178,0.8463661972967922,0.8923944964190661,0.925123689039342,0.9584605897708273,0.981313532142946,1.0153937381508853,1.0603730276505365,1.0917933069424066,1.106867735838824,1.1155803016650685,1.1246783268191662,1.1322161044463992,1.1407529667111271,1.1498053976813636,1.1566949455483835)
minHPD=c(0.10013992521424785, 0.10033005040709332,0.1034399399158789,0.10483005207950499,0.10487706433566714,0.1048633730292845,0.10485475457390052,0.10493260454166181,0.10514182674364722,0.10483005207950499,0.10497527177484088,0.10493260454166181,0.10498426703591918,0.10498426703591918,0.10414703074938392,0.10201458202999314,0.09980139645885365,0.1003885339744527,0.10441328276907186,0.10137401044766368,0.1115757248945334,0.1190545740723753,0.12305550936688271,0.1224615929741218,0.12250159571590051,0.12413978990240124,0.12410573705684112,0.12438510851004929,0.12413713286899458,0.12441425679726435,0.12464321036642939,0.12425809569803656,0.12438634465463674,0.12383967413073335,0.11621638027357142,0.11578528465845911,0.1154460404820849,0.11758702719272221,0.11556274409206838,0.11629288238774335,0.11541075167416025,0.04138976279766079,0.05466581029443438,0.05957253384165495,0.058602147676041605,0.05802019315434533,0.05795177565850539,0.057882430335154555,0.05637680485703988,0.05795177565850539,0.051437682049305156,0.04827013984360407,0.04865366644414547,0.03845356840483302,0.035735771872958365,0.0554297832183716,0.09637445961819227,0.09637445961819227,0.09729324338032237,0.09563819936904272,0.09387309662283808,7.020827833894094e-06,1.037946732075991e-05,1.037946732075991e-05,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,1.037946732075991e-05,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,7.020827833894094e-06,1.037946732075991e-05,1.037946732075991e-05,5.6065497045598656e-05,0.08769133391501059,0.09272988538213744,0.09249259353893055,0.09663475299515392,0.09786709658864544,0.10450361096203438,0.09918274156945371,0.10780883971485775,0.10282428759805694,0.10416035938203466,0.10584265328724156,0.10960190270517628,0.10612808007688065,0.11608506587103913)
maxHPD=c(0.16895865671826618, 0.16830259095456168,0.16674842140186025,0.16564757611318567,0.1652641047008649,0.1652641047008649,0.1652641047008649,0.16535988655861927,0.165645125300345,0.16540893307614804,0.1656490747337093,0.165814488216819,0.16615243007566974,0.1667779676918079,0.1675581716590542,0.16971281560115745,0.1755474197096894,0.19681083267997057,0.21982599010782658,0.4281210184658976,0.49178725833258846,0.23855843819359746,0.22748148290573403,0.22610963850963492,0.22592316303031404,0.22747754603069242,0.22748148290573403,0.22803458066861668,0.22898690792994805,0.2306266483644629,0.2318338019893898,0.23194660906127462,0.2335743860773849,0.23662491294727053,0.28084267310126054,0.8571761588899904,1.113285297089359,1.3301472504965837,1.2920710436364833,1.359240318196049,1.5718419789275189,0.3187300718540277,0.29614459829572837,0.2955354907992419,0.29551950601415894,0.29543820013956573,0.29578550401496356,0.2963243795087923,0.2963243795087923,0.29995809267386986,0.29747873846615647,0.3016379105313719,0.31796300829614976,0.3643552199457461,0.495750612246148,0.6132376820236389,0.6769070358036127,0.6802941383246687,0.6619912563009924,0.6811205661958077,0.6972617102613735,0.5950428154213636,0.5977299642464632,0.6124234900352535,0.6368399626902734,0.6789832175997399,0.742924919151536,0.8798830884630026,1.1535567660683574,1.5420941609680954,1.849784748549246,2.060270857365352,2.2493795630100513,2.4107378574804055,2.569745971552499,2.7132371005829143,2.8368956180616074,2.9379980189525985,3.0075625576325296,3.0643044216106547,3.1133965478545895,3.154776195787548,3.2005980525123965,3.238330387419623,3.2806071681539533,3.302607905535624,3.395720406860771,3.400443062713973,3.3985496159932924,3.401277443349305,3.4284346039356715,3.488015836933771,3.5188438405376896,3.5446271837804297,3.5474365934413,3.5603864975624258,3.5711559801063038,3.5827343870178177,3.5858957477725086,3.602099523584877)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.962309475943365), xlim = c(-165.450783,-0.0), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-0.8356100151515151, -2.5068300454545454,-4.178050075757575,-5.849270106060606,-7.520490136363636,-9.191710166666667,-10.862930196969698,-12.534150227272727,-14.205370257575757,-15.876590287878786,-17.547810318181817,-19.219030348484846,-20.890250378787876,-22.56147040909091,-24.232690439393938,-25.903910469696967,-27.575130499999997,-29.246350530303026,-30.91757056060606,-32.588790590909085,-34.26001062121212,-35.93123065151515,-37.602450681818176,-39.27367071212121,-40.94489074242424,-42.61611077272727,-44.2873308030303,-45.958550833333334,-47.62977086363636,-49.30099089393939,-50.97221092424242,-52.64343095454545,-54.314650984848484,-55.98587101515151,-57.65709104545454,-59.32831107575757,-60.9995311060606,-62.670751136363634,-64.34197116666667,-66.01319119696969,-67.68441122727272,-69.35563125757575,-71.02685128787878,-72.69807131818182,-74.36929134848485,-76.04051137878787,-77.7117314090909,-79.38295143939393,-81.05417146969697,-82.7253915,-84.39661153030302,-86.06783156060605,-87.73905159090909,-89.41027162121212,-91.08149165151515,-92.75271168181818,-94.4239317121212,-96.09515174242424,-97.76637177272727,-99.4375918030303,-101.10881183333333,-102.78003186363635,-104.45125189393939,-106.12247192424242,-107.79369195454545,-109.46491198484848,-111.1361320151515,-112.80735204545454,-114.47857207575757,-116.1497921060606,-117.82101213636363,-119.49223216666665,-121.16345219696969,-122.83467222727272,-124.50589225757575,-126.17711228787878,-127.84833231818182,-129.51955234848486,-131.1907723787879,-132.8619924090909,-134.53321243939394,-136.20443246969697,-137.8756525,-139.54687253030303,-141.21809256060607,-142.8893125909091,-144.56053262121213,-146.23175265151517,-147.9029726818182,-149.57419271212123,-151.24541274242424,-152.91663277272727,-154.5878528030303,-156.25907283333333,-157.93029286363637,-159.6015128939394,-161.27273292424243,-162.94395295454547,-164.6151729848485)
counts=c(0.0023002300230023, 0.0178017801780178,0.014791479147914791,0.00427042704270427,0.0017701770177017701,0.0008700870087008701,0.0006600660066006601,0.00091009100910091,0.0008500850085008501,0.00113011301130113,0.0013001300130013002,0.002000200020002,0.00391039103910391,0.008570857085708572,0.01627162716271627,0.023332333233323333,0.052755275527552756,0.10613061306130613,0.14694469446944694,0.029762976297629765,0.06765676567656766,0.015931593159315933,0.0036003600360036,0.004340434043404341,0.00605060506050605,0.00555055505550555,0.00898089808980898,0.011741174117411742,0.00629062906290629,0.0045804580458045805,0.0033203320332033204,0.00551055105510551,0.020542054205420542,0.07328732873287329,0.05907590759075908,0.049614961496149614,0.0241024102410241,0.01764176417641764,0.03306330633063306,0.07968796879687969,0.12271227122712271,0.010761076107610762,0.004090409040904091,0.00282028202820282,0.0020702070207020704,0.0019101910191019103,0.00261026102610261,0.0035603560356035602,0.005120512051205121,0.0074907490749074905,0.009770977097709771,0.022332233223322333,0.03239323932393239,0.036203620362036205,0.03559355935593559,0.021592159215921593,0.013461346134613462,0.014691469146914691,0.007430743074307431,0.021482148214821483,0.01295129512951295,0.00819081908190819,0.009850985098509851,0.01062106210621062,0.014621462146214622,0.017721772177217723,0.022612261226122612,0.025182518251825183,0.029382938293829382,0.029672967296729674,0.031393139313931395,0.037143714371437146,0.041724172417241724,0.044854485448544854,0.04558455845584559,0.04635463546354635,0.03594359435943594,0.034183418341834186,0.032673267326732675,0.02843284328432843,0.030663066306630665,0.02859285928592859,0.02981298129812981,0.025122512251225124,0.025202520252025202,0.02115211521152115,0.01987198719871987,0.01643164316431643,0.01872187218721872,0.02468246824682468,0.018691869186918692,0.011411141114111411,0.00891089108910891,0.008970897089708971,0.009320932093209321,0.00936093609360936,0.009020902090209022,0.008420842084208421,0.00793079307930793)
plot(mids,counts,type = 'h', xlim = c(-165.450783,-0.0), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
net_rate=c(0.04353915859062329, 0.042289851865796355,0.040556051533950296,0.03938510107576876,0.03908243444039992,0.038974808128481066,0.038940241818577755,0.03893750556366539,0.03895565386906226,0.0389741853470826,0.03908714334313558,0.03949435337565118,0.03919396363486648,0.03905907032967808,0.03864786403118357,0.03764607267931367,0.03641175506529233,0.032939564008089346,0.02350259662220496,-0.010011422726352125,-0.01918880345852,0.0029204479197485803,0.01248809053015292,0.012728612005905934,0.01252341690881059,0.012151944392511318,0.011776062433283484,0.01131523311702008,0.010808808722322653,0.011489567625395727,0.013852207707430422,0.024319286848325405,0.05155077920710785,0.10558024165369373,0.448736634363077,0.4666765329879561,0.3705227456035051,0.1697355859534868,0.029765506359736453,-0.060734622559201826,-0.15063394371610786,0.03498894839584808,0.04768763113295547,0.0501326589821461,0.051434179157614966,0.05193258076044567,0.05219889239740753,0.0523865538061975,0.05329784857344177,0.05522631944531712,0.05714443029901921,0.06702834720447685,0.06928165947102378,0.0579739596323375,0.042210827667267616,0.024285581358934022,0.009269540244076637,0.00809657913681248,0.022964578231827397,0.036053949869663336,0.05000203801372598,0.0637273896867077,0.06791431646935878,0.07527274602253581,0.07782571006293479,0.0805596089682671,0.08346281485419835,0.09083263256087193,0.08814155904998117,0.09775112476158307,0.08762657141664774,0.08148199969937929,0.07746379543723299,0.08381767558799927,0.09253161034381174,0.07439189259087463,0.051213094765133894,0.028831591464702946,0.019794358512929718,0.006751173000609483,-0.0037294810910996007,-0.01165023263087802,-0.02087101913117117,-0.03032247871852974,-0.04093445647531865,-0.04704072729064444,-0.054752035809551416,-0.0595875320678483,-0.06480524334344406,-0.05295575780573633,-0.0032625881140093283,0.007610213441679997,0.007320486553247342,0.0065277840207099294,0.005423934187380069,0.004639488007577557,0.002433886634169346,0.0017823550015886593,0.0008047458328143332,0.00017838401962491255)
net_minHPD=c(-0.0020250131936600246, -0.0014394088762190727,0.0004235619884358499,0.0020092233592775843,0.0020954022024497754,0.002474301654508626,0.0021802589910674686,0.0021077089605091304,0.0020954022024497754,0.0020495001692551196,0.0020058438363280695,0.0013439117878887297,0.0013546287128587409,0.0007825225407866176,-0.00026327624375649394,-0.0033143551314318564,-0.007873863156374422,-0.02430479258498844,-0.04723457069578435,-0.257982809005988,-0.32335640943151384,-0.06576648524482936,-0.05414560143488639,-0.05305586967721301,-0.05305586967721301,-0.05324772759823315,-0.05408457356021282,-0.05590499578055422,-0.05829303349586709,-0.062085271065864145,-0.07330990259607598,-0.08802453388563808,-0.08024009424668074,-0.0957739355719189,-0.0766479188115814,-0.16779814755573108,-0.5440353570956553,-0.7743870575134073,-0.9834025407584798,-1.168970852543827,-1.458567137718084,-0.10622773736689009,-0.07518112685853617,-0.06819667879076802,-0.0653584167308624,-0.06469108349373764,-0.06480151593325637,-0.06582700266798733,-0.06066811533985139,-0.06835660490837259,-0.07475523590426089,-0.10828679732864499,-0.1518127845416255,-0.17712718172653621,-0.37386193450326954,-0.40690993719250573,-0.40690993719250573,-0.4068902507241569,-0.3396949142757302,-0.2917022569508137,-0.2904026561273191,-0.24455364480437422,-0.25991231475858767,-0.29536438892746025,-0.33156711194865307,-0.3944364040529975,-0.6183957802100599,-0.8492350770483331,-1.3098575489157949,-1.5621965981004435,-1.8326327109033156,-1.9706569687450244,-2.2267027910564425,-2.3498352368060402,-2.5033009445857215,-2.585017964042678,-2.6667878426819613,-2.725841717836624,-2.7298771665503905,-2.7488208595873758,-2.7469753879482135,-2.7543002588522243,-2.7533750119941502,-2.7498495992232983,-2.679844833852133,-2.672118341681932,-2.672157049938416,-2.654092199363328,-2.6299388158084827,-2.5900566542077987,-2.672748341926911,-2.702149146225054,-2.7337923735047727,-2.7499575207988207,-2.7330862459611485,-2.758022493766939,-2.8240340724458903,-2.803177579711121,-2.8240340724458903,-2.734645935319913)
net_maxHPD=c(0.08968150252023925, 0.08562260788318715,0.0804093293333078,0.0786471568004488,0.078122006548253,0.07842934282008406,0.07812366429867174,0.07805289357742055,0.07805246782222373,0.07812366429867174,0.07836319922594391,0.07825868716458681,0.07842934282008406,0.07842934282008406,0.07917920316525748,0.0807431998981295,0.08293714473373522,0.08285637617191235,0.0781219233413854,0.0858802394368395,0.0763180912246598,0.06785820999637748,0.06182408378245327,0.06211389618176519,0.062109229499721946,0.062186996092358116,0.06209133298671407,0.06141554067553212,0.062186996092358116,0.06491684174587153,0.06872503392023704,0.1511296143528959,0.30926170472764514,0.6004423909414893,1.6524736875797688,1.9432575340653302,1.8828731915780064,1.4750451569280296,1.0675478915187693,0.8118514106283015,0.29161890266520096,0.22495018303599432,0.19996209462617573,0.19661374872522722,0.1966198468670222,0.1966756831431666,0.1966756831431666,0.19668246094987002,0.2043457275813229,0.2044516156758778,0.21672764590825105,0.26670512210642067,0.3676902336529031,0.4527014933574037,0.31878179821030983,0.3052620141540834,0.29589165545550533,0.28893211003624913,0.286288327257053,0.3015456260608036,0.33151329324492035,0.35327971927487867,0.36979138035866554,0.41553643633326987,0.5202601065977708,0.727189430307481,1.0127126935300415,1.5797646947232886,1.7283660751614252,2.120498059027998,2.2048451005058958,2.3592494263470956,2.369873186179137,2.461153471198205,2.607379855936376,2.6787763616796347,2.6810793254369885,2.6601914886583633,2.669006743859197,2.6598494007372917,2.64784317759388,2.616654621914667,2.578026876758945,2.5260468301291765,2.522910970326653,2.5022563980164625,2.4867368587957337,2.478434480086378,2.4636075959190813,2.4794788346038024,2.5887224291353985,2.744553119243055,2.7809084705332756,2.793587656035199,2.829567070977462,2.829567070977462,2.780276891405626,2.820987762832158,2.8223769119729534,2.9294374402253545)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-3.1064374796904795, 3.22238118424789), xlim = c(-165.450783,-0.0), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-0.827253915, -2.481761745,-4.136269575,-5.790777405,-7.445285235,-9.099793065,-10.754300895,-12.408808725,-14.063316555,-15.717824385,-17.372332215,-19.026840045,-20.681347875,-22.335855705,-23.990363535,-25.644871365,-27.299379195,-28.953887025,-30.608394855,-32.262902685,-33.917410515,-35.571918345,-37.226426175,-38.880934005,-40.535441835,-42.189949665,-43.844457495,-45.498965325,-47.153473155,-48.807980985,-50.462488815,-52.116996645,-53.771504475,-55.426012305,-57.080520135,-58.735027965,-60.389535795,-62.044043625,-63.698551455,-65.353059285,-67.007567115,-68.662074945,-70.316582775,-71.971090605,-73.625598435,-75.280106265,-76.934614095,-78.589121925,-80.243629755,-81.898137585,-83.552645415,-85.207153245,-86.861661075,-88.516168905,-90.170676735,-91.825184565,-93.479692395,-95.134200225,-96.788708055,-98.443215885,-100.097723715,-101.752231545,-103.406739375,-105.061247205,-106.715755035,-108.370262865,-110.024770695,-111.679278525,-113.333786355,-114.988294185,-116.642802015,-118.297309845,-119.951817675,-121.606325505,-123.260833335,-124.915341165,-126.569848995,-128.224356825,-129.878864655,-131.533372485,-133.187880315,-134.842388145,-136.496895975,-138.151403805,-139.805911635,-141.460419465,-143.114927295,-144.769435125,-146.423942955,-148.078450785,-149.732958615,-151.387466445,-153.041974275,-154.696482105,-156.350989935,-158.005497765,-159.660005595,-161.314513425,-162.969021255,-164.623529085)
rate=c(7.464123328688877, 7.454327701524615,7.3704407090709525,7.308357686816603,7.29354958841169,7.288719017593827,7.2877837603541185,7.28839380437118,7.289398622093383,7.289810110232231,7.289999395818662,7.290914342378899,7.290276116295567,7.283848718453772,7.261510393970921,7.2082207764395,7.143301495307091,6.969353062199552,6.538045531641736,5.361072415484169,5.10686924017829,5.756698618518325,6.091823056926794,6.1007130468329915,6.093209845636838,6.07840465919403,6.063430326798155,6.042545914267934,6.001817839908677,5.974685406452697,5.961349620365295,5.957952281319346,5.942877892855935,5.895616711274913,5.157789215539625,3.8885259827329817,3.287312963094764,2.88176324805626,2.9142392556043832,2.785394693930732,2.5236865720099644,5.161930745380997,5.535534256695764,5.587864895613918,5.596997531136953,5.598260469575828,5.596290129381035,5.590789235994364,5.579792570437211,5.56025899134361,5.518802577844119,5.447032553742274,5.287117831141496,4.931669127604786,4.557443465427211,4.201601252752563,3.939833855232527,3.8974911192864403,4.05279617549708,4.12958816938881,4.155469095529328,4.316888008193922,4.325847512341862,4.242076111693511,4.0636196147739465,3.8388341680767857,3.5735208046972775,3.2589615542983266,2.935657885692234,2.621154169642113,2.345871715922416,2.1283601863296897,1.9318982959404725,1.750159932643291,1.5779048814735943,1.4261074374968348,1.2981429720109354,1.1920434735481324,1.1297532510684054,1.0737031349151949,1.0274189884952745,0.9893398513096018,0.9523317281034236,0.9201465037854872,0.888562665321488,0.8668099455366407,0.8461338558398099,0.8305798517339679,0.8161195569625672,0.8054127316137287,0.7886551509776205,0.7640808872546084,0.7487686709770546,0.7417323879350881,0.737653828883792,0.7334488961792501,0.729451539151332,0.7257342969939048,0.7218433329768373,0.7184032539056092)
minHPD=c(7.464123328688877, 7.454327701524615,7.3704407090709525,7.308357686816603,7.29354958841169,7.288719017593827,7.2877837603541185,7.28839380437118,7.289398622093383,7.289810110232231,7.289999395818662,7.290914342378899,7.290276116295567,7.283848718453772,7.261510393970921,7.2082207764395,7.143301495307091,6.969353062199552,6.538045531641736,5.361072415484169,5.10686924017829,5.756698618518325,6.091823056926794,6.1007130468329915,6.093209845636838,6.07840465919403,6.063430326798155,6.042545914267934,6.001817839908677,5.974685406452697,5.961349620365295,5.957952281319346,5.942877892855935,5.895616711274913,5.157789215539625,3.8885259827329817,3.287312963094764,2.88176324805626,2.9142392556043832,2.785394693930732,2.5236865720099644,5.161930745380997,5.535534256695764,5.587864895613918,5.596997531136953,5.598260469575828,5.596290129381035,5.590789235994364,5.579792570437211,5.56025899134361,5.518802577844119,5.447032553742274,5.287117831141496,4.931669127604786,4.557443465427211,4.201601252752563,3.939833855232527,3.8974911192864403,4.05279617549708,4.12958816938881,4.155469095529328,4.316888008193922,4.325847512341862,4.242076111693511,4.0636196147739465,3.8388341680767857,3.5735208046972775,3.2589615542983266,2.935657885692234,2.621154169642113,2.345871715922416,2.1283601863296897,1.9318982959404725,1.750159932643291,1.5779048814735943,1.4261074374968348,1.2981429720109354,1.1920434735481324,1.1297532510684054,1.0737031349151949,1.0274189884952745,0.9893398513096018,0.9523317281034236,0.9201465037854872,0.888562665321488,0.8668099455366407,0.8461338558398099,0.8305798517339679,0.8161195569625672,0.8054127316137287,0.7886551509776205,0.7640808872546084,0.7487686709770546,0.7417323879350881,0.737653828883792,0.7334488961792501,0.729451539151332,0.7257342969939048,0.7218433329768373,0.7184032539056092)
maxHPD=c(7.464123328688877, 7.454327701524615,7.3704407090709525,7.308357686816603,7.29354958841169,7.288719017593827,7.2877837603541185,7.28839380437118,7.289398622093383,7.289810110232231,7.289999395818662,7.290914342378899,7.290276116295567,7.283848718453772,7.261510393970921,7.2082207764395,7.143301495307091,6.969353062199552,6.538045531641736,5.361072415484169,5.10686924017829,5.756698618518325,6.091823056926794,6.1007130468329915,6.093209845636838,6.07840465919403,6.063430326798155,6.042545914267934,6.001817839908677,5.974685406452697,5.961349620365295,5.957952281319346,5.942877892855935,5.895616711274913,5.157789215539625,3.8885259827329817,3.287312963094764,2.88176324805626,2.9142392556043832,2.785394693930732,2.5236865720099644,5.161930745380997,5.535534256695764,5.587864895613918,5.596997531136953,5.598260469575828,5.596290129381035,5.590789235994364,5.579792570437211,5.56025899134361,5.518802577844119,5.447032553742274,5.287117831141496,4.931669127604786,4.557443465427211,4.201601252752563,3.939833855232527,3.8974911192864403,4.05279617549708,4.12958816938881,4.155469095529328,4.316888008193922,4.325847512341862,4.242076111693511,4.0636196147739465,3.8388341680767857,3.5735208046972775,3.2589615542983266,2.935657885692234,2.621154169642113,2.345871715922416,2.1283601863296897,1.9318982959404725,1.750159932643291,1.5779048814735943,1.4261074374968348,1.2981429720109354,1.1920434735481324,1.1297532510684054,1.0737031349151949,1.0274189884952745,0.9893398513096018,0.9523317281034236,0.9201465037854872,0.888562665321488,0.8668099455366407,0.8461338558398099,0.8305798517339679,0.8161195569625672,0.8054127316137287,0.7886551509776205,0.7640808872546084,0.7487686709770546,0.7417323879350881,0.737653828883792,0.7334488961792501,0.729451539151332,0.7257342969939048,0.7218433329768373,0.7184032539056092)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.210535661557765), xlim = c(-165.450783,-0.0), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()